#!/bin/bash
# ----------------------------------------------------
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –∑–±—ñ—Ä–∫–∏ —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –≤ Minikube
# ----------------------------------------------------

# 1. –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ Docker-—Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –Ω–∞ Minikube
echo "üöÄ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Docker-—Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ Minikube..."
eval $(minikube docker-env)

# 2. –ó–±–∏—Ä–∞—î–º–æ –æ–±—Ä–∞–∑ Keycloak (–í–ò–ü–†–ê–í–õ–ï–ù–û)
echo "üì¶ –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É sn-keycloak:latest..."
docker build -t sn-keycloak:latest -f ./sn-keycloak-rabbitmq-provider/Dockerfile ./sn-keycloak-rabbitmq-provider

# 3. –ó–±–∏—Ä–∞—î–º–æ –æ–±—Ä–∞–∑ sn-user
echo "üì¶ –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É sn-user:latest..."
docker build -t sn-user:latest -f Dockerfile-sn-user .

echo "‚úÖ –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—ñ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"

# 4. –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –≤—Å—ñ .yml –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑ –ø–∞–ø–∫–∏ k8s/
echo "üöÄ –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å—ñ–≤ —É Kubernetes..."
kubectl apply -f k8s/

echo "üéâ –ì–æ—Ç–æ–≤–æ! –£—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞–ø—É—â–µ–Ω—ñ."